import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMw0KIyBwcm9mZXNzaW9uYWxfc2FmZV9zY2FubmVyX3YzLnB5DQoiIiINClByb2ZTY2FuIFBybyB2Mw0KLSBBZGRzIENWRSBEQiBpbnRlZ3JhdGlvbiAoLS1jdmUtZGIpIGFuZCBvcHRpb25hbCBwYXJhbGxlbCBjcmF3bGluZyAoLS1wYXJhbGxlbCkNCi0gU2FmZS1ieS1kZWZhdWx0OyBvcHRpb25hbCBiZW5pZ24gcHJvYmluZyAoLS1wcm9iZSkgcmVxdWlyZXMgZXhwbGljaXQgcGVybWlzc2lvbg0KRGV2ZWxvcGVyOiBBUllBWFoNClZlcnNpb246IDMuMC4wDQoiIiINCmltcG9ydCBhcmdwYXJzZQ0KaW1wb3J0IG9zDQppbXBvcnQgcmUNCmltcG9ydCBqc29uDQppbXBvcnQgdGltZQ0KaW1wb3J0IHJhbmRvbQ0KaW1wb3J0IHN0cmluZw0KaW1wb3J0IHNvY2tldA0KaW1wb3J0IHRocmVhZGluZw0KaW1wb3J0IGRpZmZsaWINCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCB1cmxqb2luLCB1cmxwYXJzZSwgcGFyc2VfcXMNCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lDQpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBkZWZhdWx0ZGljdCwgT3JkZXJlZERpY3QsIGRlcXVlDQpmcm9tIGNvbmN1cnJlbnQuZnV0dXJlcyBpbXBvcnQgVGhyZWFkUG9vbEV4ZWN1dG9yLCBhc19jb21wbGV0ZWQNCg0KaW1wb3J0IHJlcXVlc3RzDQpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cA0KDQojIE9wdGlvbmFsIG5pY2V0aWVzDQp0cnk6DQogICAgaW1wb3J0IHRsZGV4dHJhY3QNCmV4Y2VwdCBFeGNlcHRpb246DQogICAgdGxkZXh0cmFjdCA9IE5vbmUNCg0KdHJ5Og0KICAgIGZyb20gY29sb3JhbWEgaW1wb3J0IGluaXQgYXMgY29sb3JhbWFfaW5pdCwgRm9yZSwgU3R5bGUNCiAgICBjb2xvcmFtYV9pbml0KGF1dG9yZXNldD1UcnVlKQ0KICAgIENPTE9SX0VOQUJMRUQgPSBUcnVlDQpleGNlcHQgRXhjZXB0aW9uOg0KICAgIENPTE9SX0VOQUJMRUQgPSBGYWxzZQ0KICAgIGNsYXNzIEZvcmU6DQogICAgICAgIFJFRCA9ICIiOyBHUkVFTj0iIjsgWUVMTE9XPSIiOyBNQUdFTlRBPSIiOyBDWUFOPSIiOyBCTFVFPSIiOyBXSElURT0iIg0KICAgIGNsYXNzIFN0eWxlOg0KICAgICAgICBCUklHSFQgPSAiIjsgUkVTRVRfQUxMID0gIiINCg0KIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQojIE1ldGFkYXRhICYgZGVmYXVsdHMNCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KVE9PTF9OQU1FID0gIkJBTkRBUiBCT0tFUCINClZFUlNJT04gPSAiMy4wLjAiDQpERVZFTE9QRVIgPSAiUEVOR09DT0sgSEFOREFMIg0KVVNFUl9BR0VOVCA9IGYie1RPT0xfTkFNRX0ve1ZFUlNJT059IChkZWZlbnNpdmUtb25seSkiDQpUSU1FT1VUID0gMTINClBPTElURV9ERUxBWSA9IDAuMTgNCk1BWF9QQUdFU19ERUZBVUxUID0gNDAwDQpSRVBPUlRTX0RJUiA9ICJyZXBvcnRzIg0Kb3MubWFrZWRpcnMoUkVQT1JUU19ESVIsIGV4aXN0X29rPVRydWUpDQoNCkNPTU1PTl9GSUxFUyA9IFsNCiAgICAiLmVudiIsICJ3cC1jb25maWcucGhwIiwgImJhY2t1cC56aXAiLCAiYmFja3VwLnRhci5neiIsICIuZ2l0L0hFQUQiLCAiLmdpdC9jb25maWciLA0KICAgICIuc3ZuL2VudHJpZXMiLCAiY29uZmlnLnBocCIsICJyZWFkbWUuaHRtbCIsICJSRUFETUUubWQiLCAiZGF0YWJhc2Uuc3FsIg0KXQ0KDQpFUlJPUl9TSUdOQVRVUkVTID0gew0KICAgICJteXNxbCI6IFtyIlNRTCBzeW50YXguKk15U1FMIiwgciJ5b3UgaGF2ZSBhbiBlcnJvciBpbiB5b3VyIFNRTCBzeW50YXgiLCByIm15c3FsX2ZldGNoX2FycmF5XCgiXSwNCiAgICAicG9zdGdyZXMiOiBbciJQRzo6U3ludGF4RXJyb3IiLCByIlBvc3RncmVTUUwuKkVSUk9SIiwgciJvcmcucG9zdGdyZXNxbCJdLA0KICAgICJtc3NxbCI6IFtyIk1pY3Jvc29mdCBTUUwgU2VydmVyIiwgciJVbmNsb3NlZCBxdW90YXRpb24gbWFyayBhZnRlciB0aGUgY2hhcmFjdGVyIHN0cmluZyJdLA0KICAgICJwaHAiOiBbciJvbiBsaW5lIFxkKyBpbiAvIiwgciJGYXRhbCBlcnJvcjouKiBvbiBsaW5lIl0sDQogICAgImphdmEiOiBbciJFeGNlcHRpb24gaW4gdGhyZWFkIFwibWFpblwiIiwgciJhdCBqYXZhXC4iXSwNCiAgICAicHl0aG9uIjogW3IiVHJhY2ViYWNrIFwobW9zdCByZWNlbnQgY2FsbCBsYXN0XCk6IiwgciJGaWxlIFwiLipcIiwgbGluZSBcZCsiXQ0KfQ0KDQpIRVVSSVNUSUNfTUFQID0gew0KICAgICJpZCI6IFsic3FsX2luamVjdGlvbl9jYW5kaWRhdGUiLCAiZGJfbG9va3VwIl0sDQogICAgInBhZ2UiOiBbImxmaV9jYW5kaWRhdGUiLCAiaW5jbHVkZSJdLA0KICAgICJmaWxlIjogWyJsZmlfY2FuZGlkYXRlIiwgImZpbGVfaW5jbHVkZSJdLA0KICAgICJwYXRoIjogWyJ0cmF2ZXJzYWxfY2FuZGlkYXRlIl0sDQogICAgInVybCI6IFsic3NyZl9jYW5kaWRhdGUiLCAib3Blbl9yZWRpcmVjdF9jYW5kaWRhdGUiXSwNCiAgICAicmVkaXJlY3QiOiBbIm9wZW5fcmVkaXJlY3RfY2FuZGlkYXRlIl0sDQogICAgIm5hbWUiOiBbInhzc19jYW5kaWRhdGUiXSwNCiAgICAiY29tbWVudCI6IFsieHNzX3N0b3JlZF9jYW5kaWRhdGUiXSwNCiAgICAic2VhcmNoIjogWyJ4c3Nfb3Jfc3FsaV9jYW5kaWRhdGUiXSwNCiAgICAiY21kIjogWyJjb21tYW5kX2luamVjdGlvbl9jYW5kaWRhdGUiXSwNCiAgICAiZXhlYyI6IFsiY29tbWFuZF9pbmplY3Rpb25fY2FuZGlkYXRlIl0sDQogICAgInRva2VuIjogWyJzZW5zaXRpdmVfdG9rZW5fZXhwb3N1cmUiXQ0KfQ0KDQpTRU5TSVRJVkVfUEFUVEVSTlMgPSBbciJhcGlbXy1dP2tleSIsIHIiYXdzX3NlY3JldCIsIHIicHJpdmF0ZV9rZXkiLCByInBhc3N3b3JkIiwgciJwYXNzd2QiLCByInNlY3JldCIsIHIidG9rZW4iXQ0KDQojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMgVXRpbGl0aWVzDQojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCmRlZiBiYW5uZXIoKToNCiAgICBhcnQgPSByIiIiDQrioKDioYDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIANCuKggOKgmOKit+KhgOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKjtOKjvw0K4qCA4qCA4qK44qO/4qGE4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qK44qO/4qO/DQrioIDioIDioIDio7/io7/ioYDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDio7/io7/io78NCuKggOKggOKggOKjv+Kjv+Kjt+KhgOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKjv+Kjv+Kjvw0K4qCA4qCA4qCA4qO/4qO/4qO/4qO34qOE4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qKA4qOA4qOA4qOA4qOA4qOA4qOA4qOA4qOA4qOA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qO84qO/4qO/4qG/4qOP4qO/DQrioIDioIDioIDiorvio7/io7/io7/io7/io7fio6bio4DioIDioIDioIDioIDio4Dio6Tio7Tio7bio7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7fio7bio6bio4Tio4DioIDioIDioIDio4Dio7zio7/io7/io7/io7/io7/io77ioZ/ioIPioIANCuKggOKggOKggOKguOKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+KjtuKjpOKjneKjm+Khu+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Khv+KjmeKjreKjpeKjtuKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Khh+KggOKggOKggA0K4qCA4qCA4qCA4qCA4qK74qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qOn4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO34qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qG/4qCA4qCA4qCA4qCADQrioIDioIDioIDioIDioIjior/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ioY/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ioYfio7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ioIPioIDioIDioIDioIANCuKggOKggOKggOKggOKggOKiiOKiv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kin+KjvOKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+KjjOKiv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Khv+Kio+KggOKggOKggOKggOKggA0K4qCA4qCA4qCA4qCA4qKg4qO/4qOm4qO94qOb4qO74qC/4qC/4qOf4qOb4qO14qO+4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO34qOt4qOb4qOb4qOb4qOb4qO74qOt4qO24qO/4qOn4qCA4qCA4qCA4qCADQrioIDioIDioIDioIDio77io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ior/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ioYbioIDioIDioIANCuKggOKggOKggOKisOKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+KhuOKjv+Khj+Kiv+Kjv+Kjv+Kjv+Khn+KjvOKjv+KiueKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjt+KggOKggOKggA0K4qCA4qCA4qCA4qK44qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qOn4qC54qO/4qGI4qK/4qO/4qCf4qKw4qO/4qKD4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qCA4qCA4qCADQrioIDioIDioIDiorjio7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ioYbioLnio7fioYDioInioqDio7/ioI/io7jio7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ioIDioIDioIANCuKggOKggOKggOKggOKjv+Kjv+Kjv+Kjv+Kjr+KjjeKhm+Kgu+Kgv+Kiv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Khv+KggOKjv+Kjt+KjtuKjv+Khn+KggOKiv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kgv+Kgv+Kgm+Kii+KjqeKjteKjvuKjv+Kjv+Kjv+Khn+KggOKggOKggA0K4qCA4qCA4qCA4qCA4qO/4qO/4qOc4qK/4qO/4qO/4qO/4qO/4qO24qO24qOk4qOk4qOk4qOJ4qOJ4qOJ4qOB4qOA4qOg4qO04qO/4qO/4qO/4qO/4qO/4qOk4qOE4qOA4qOA4qOA4qOg4qOk4qOk4qO04qO24qO+4qO/4qO/4qO/4qO/4qG/4qKL4qO+4qO/4qOH4qCA4qCA4qCADQrioIDioIDioIDiorDio7/io7/io7/io7fio67ioZ3ioLvioL/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ior/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/ioL/ioJ/ioJvioqnio77io7/io7/io7/iob/io4TioIDioIANCuKggOKggOKisOKhj+KgmOKiv+Kjv+Kjv+Kjv+Kjh+KggOKggOKggOKggOKgieKireKjreKjveKhn+Kgm+Kgm+Kgm+Kgi+KigeKjv+Kjv+Kjv+Kjv+Kjt+KhiOKgieKgieKgieKgieKireKjreKjreKgteKggOKggOKggOKggOKggOKjvOKjv+Kjv+Kjv+Kgn+KggOKjveKggOKggA0K4qCA4qCA4qCA4qK/4qOE4qCA4qC74qO/4qO/4qO/4qOG4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qO44qO/4qO/4qO/4qO/4qO/4qOH4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qKA4qO84qO/4qO/4qG/4qCD4qKA4qO+4qGf4qCA4qCADQrioIDioIDioIDioJjio7/io7fio6Tio4jioJvioL/io7/io7fio6bio4TioYDioIDioIDioIDioIDioIDio4Dio6Tio77iob/iorjio7/io7/io7/ioYfior/io7fio6Tio4DioYDioIDioIDioIDiooDio4Dio6Tio7bio7/iob/ioJ/io4nio6Tio7Tio7/iob/ioIDioIDioIANCuKggOKggOKggOKggOKguOKjv+Kjv+Kjv+Kjv+Kjt+KjvuKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kig+KjvuKjv+Kjv+Kjv+Kjt+KhiOKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+KjvuKjv+Kjv+Kjv+Kjv+Khv+KggeKggOKggOKggA0K4qCA4qCA4qCA4qCA4qCA4qK54qO/4qOt4qG74qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO+4qO/4qO/4qO/4qO/4qO/4qO34qO84qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qG/4qOr4qO24qO24qGH4qCA4qCA4qCA4qCADQrioIDioIDioIDioIDioIDio7jio7/io7/ioZ/ioojio63io5/io5vioL/ioL/io7/io7/io7/ioJ/io6nio6Tio6zio53ior/io7/io7/io7/io7/io7/io7/io6vio6Xio7bio4zioJnioL/iob/ioL/ioL/io5vio6vio63io6fio4Tiornio7/io7/io4fioIDioIDioIDioIANCuKggOKggOKggOKggOKggOKjv+Kjv+Kjv+Kjh+Kjv+Kjv+Kim+Kjr+Kjn+Kiv+KjtuKjtuKjtuKhh+Kjv+Kjv+Kjv+Kjv+KjvuKjv+Kjv+Kjv+Kjv+Kjv+Kjt+Kjv+Kjv+Kjv+Kjv+KiuOKjv+KjvuKjv+Kin+Kjr+KjreKjneKiu+Kjv+KjvOKjv+Kjv+Khv+KggOKggOKggOKggA0K4qCA4qCA4qCA4qCA4qCA4qK44qO/4qO/4qO/4qG/4qO14qO/4qO/4qO/4qO34qK54qO/4qO/4qOH4qK/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qG/4qO44qO/4qO/4qGP4qO+4qO/4qO/4qO/4qOn4qG54qO/4qO/4qO/4qCH4qCA4qCA4qCA4qCADQrioIDioIDioIDioIDioIDioIDior/iob/ioovio77io7/io7/io7/io7/ioJ/ioojior/io7/io7/io7fio6Tio4nioJnioL/io7/io7/io7/io7/io7/ioL/ioJvio4nio6Tio77io7/io7/iob/ioYHioJnior/io7/io7/io7/io7/io4zioLviob/ioIDioIDioIDioIDioIANCuKggOKggOKggOKggOKggOKigOKjqOKjtuKjv+Kjv+Khv+Kin+Kgi+KggOKggOKiuOKhjuKgu+Kjv+Kjv+Kjv+Kjv+Kjv+KjtuKjruKjreKjv+Kjr+KjteKjtuKjv+Kjv+Kjv+Kjv+Khv+Kin+KgseKhh+KggOKggOKgiOKjmeKhu+Kgv+Kjv+Kjv+KjpuKjhOKhgOKggOKggOKggA0K4qCA4qCA4qCA4qCA4qCS4qCb4qCb4qCJ4qO94qO24qO+4qO/4qOn4qCA4qCA4qCI4qCD4qO/4qO24qO24qKw4qOu4qGd4qOb4qO74qK/4qO/4qO/4qK/4qOb4qGr4qO14qO24qKy4qO+4qO/4qCA4qCD4qCA4qCA4qO44qO/4qO/4qO/4qO24qCC4qCI4qCJ4qCJ4qCA4qCA4qCADQrioIDioIDioIDioIDioIDioIDioIDioIDioJjio7/io7/io7/io7/ioYTioIDioIDioIDior/iob/ioIHioIjioJvioLfioL/ioL/ioL/ioL/ioL/ioLjioL/ioIfioJvioIHioIDiornio7/ioIDioIDioIDioIDioIjio7/io7/io7/ior/ioIPioIDioIDioIDioIDioIDioIANCuKggOKggOKggOKggOKggOKggOKggOKggOKggOKgmOKjv+Kjv+Kjv+Khh+KggOKggOKggOKgmOKgh+KggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKgi+KggOKggOKggOKggOKggOKjvuKjv+Kjv+Khv+KggOKggOKggOKggOKggA0K4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qK54qO/4qO/4qGH4qOg4qO24qCA4qCA4qCA4qCA4qOA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qKg4qGA4qCA4qCA4qKw4qOm4qCA4qCA4qKg4qO/4qO/4qO/4qCD4qCA4qCA4qCA4qCA4qCA4qCADQrioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIjio7/io7/io7/ioZnioIfio7DioYfiorDio7/ioYHioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDio73io7fiooDio4DioZzioovio7bio7/io7/io7/ioY/ioIDioIDioIDioIDioIDioIDioIDioIANCuKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKiu+Kjv+Kjv+Kjv+Kjh+Kiv+Kgl+Kjv+Kjv+Kjt+KhhOKjtOKjtuKjtOKhhuKjtuKhhuKjtuKjsOKjtuKhhOKjvuKjv+Kjv+KhnuKiv+Kjo+Kjv+Kjv+Kjv+Kjv+KggOKggOKggOKggOKggOKggOKggOKggOKggOKggA0K4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCI4qK/4qO/4qO/4qO/4qO34qOn4qG74qG/4qKf4qOj4qOb4qOj4qC74qOD4qG74qOj4qOb4qOj4qOb4qOh4qOb4qG74qG/4qOx4qO34qO/4qO/4qO/4qO/4qCD4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCADQrioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIjioLvio7/io7/io7/io7/io7fio77io7/ioL/ioL/ioL/ioL/ioL/ioL/ioL/ioL/ioL/ioL/ioL/ioL/io7/io7bio7/io7/io7/io7/iob/ioIHioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIANCuKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKgiOKgu+Kiv+Kjv+Kjv+KjreKjtuKjtuKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjt+KjtuKjtuKjveKjv+Kjv+Kgn+KgieKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggA0K4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qC54qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qG/4qCB4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCADQrioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIjioJvioL/ioJvioIvioInioIHioIDioIDioIDioIDioIjioInioJnioJvioJvioIvioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIANCg0KIiIiDQogICAgbWV0YSA9IGYie1RPT0xfTkFNRX0gIHZ7VkVSU0lPTn0gIOKAoiAgRGV2ZWxvcGVyOiB7REVWRUxPUEVSfSINCiAgICBwcmludChGb3JlLkNZQU4gKyBhcnQgKyBTdHlsZS5SRVNFVF9BTEwgaWYgQ09MT1JfRU5BQkxFRCBlbHNlIGFydCkNCiAgICBwcmludCgoRm9yZS5ZRUxMT1cgKyBtZXRhICsgU3R5bGUuUkVTRVRfQUxMKSBpZiBDT0xPUl9FTkFCTEVEIGVsc2UgbWV0YSkNCiAgICBwcmludCgpDQoNCmRlZiBub3dfdXRjX2lzbygpOg0KICAgIHJldHVybiBkYXRldGltZS51dGNub3coKS5pc29mb3JtYXQoKSArICJaIg0KDQpkZWYgcmFuZG9tX3Rva2VuKHByZWZpeD0iUFJCIik6DQogICAgcmV0dXJuIGYie3ByZWZpeH0tIiArICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoc3RyaW5nLmFzY2lpX3VwcGVyY2FzZSArIHN0cmluZy5kaWdpdHMsIGs9OCkpDQoNCmRlZiBzYWZlX2dldCh1cmwsIHBhcmFtcz1Ob25lLCBtZXRob2Q9IkdFVCIsIGhlYWRlcnM9Tm9uZSk6DQogICAgaGVhZGVycyA9IGhlYWRlcnMgb3Ige30NCiAgICBoZWFkZXJzLnNldGRlZmF1bHQoIlVzZXItQWdlbnQiLCBVU0VSX0FHRU5UKQ0KICAgIHRyeToNCiAgICAgICAgaWYgbWV0aG9kID09ICJIRUFEIjoNCiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5oZWFkKHVybCwgcGFyYW1zPXBhcmFtcywgaGVhZGVycz1oZWFkZXJzLCB0aW1lb3V0PVRJTUVPVVQsIGFsbG93X3JlZGlyZWN0cz1UcnVlKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCh1cmwsIHBhcmFtcz1wYXJhbXMsIGhlYWRlcnM9aGVhZGVycywgdGltZW91dD1USU1FT1VULCBhbGxvd19yZWRpcmVjdHM9VHJ1ZSkNCiAgICAgICAgcmV0dXJuIHINCiAgICBleGNlcHQgRXhjZXB0aW9uOg0KICAgICAgICByZXR1cm4gTm9uZQ0KDQpkZWYgZG9tYWluX3NhZmVfbmFtZSh1cmwpOg0KICAgIHAgPSB1cmxwYXJzZSh1cmwpDQogICAgaG9zdCA9IHAubmV0bG9jDQogICAgcmV0dXJuIHJlLnN1YihyIlteQS1aYS16MC05Ll8tXSIsICJfIiwgaG9zdCkNCg0KZGVmIGNvbG9yKHRleHQsIGZvcmU9Rm9yZS5XSElURSwgYnJpZ2h0PUZhbHNlKToNCiAgICBpZiBub3QgQ09MT1JfRU5BQkxFRDoNCiAgICAgICAgcmV0dXJuIHRleHQNCiAgICByZXR1cm4gKFN0eWxlLkJSSUdIVCBpZiBicmlnaHQgZWxzZSAiIikgKyBmb3JlICsgdGV4dCArIFN0eWxlLlJFU0VUX0FMTA0KDQojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMgU2NvcmluZyBlbmdpbmUNCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KZGVmIGNvbXB1dGVfc2NvcmUoZXZpZGVuY2UpOg0KICAgIHNjb3JlID0gMA0KICAgIHNjb3JlICs9IGV2aWRlbmNlLmdldCgicGFyYW1fbmFtZV9oZXVyaXN0aWMiLCAwKSAqIDgNCiAgICBpZiBldmlkZW5jZS5nZXQoInBhc3NpdmVfZXJyb3IiKToNCiAgICAgICAgc2NvcmUgKz0gMzANCiAgICBzY29yZSArPSBtaW4oZXZpZGVuY2UuZ2V0KCJleHBvc2VkX2ZpbGUiLCAwKSAqIDUsIDIwKQ0KICAgIHNjb3JlICs9IG1pbihldmlkZW5jZS5nZXQoInJlZmxlY3Rpb25fcGFzc2l2ZSIsIDApICogNywgMjgpDQogICAgaWYgZXZpZGVuY2UuZ2V0KCJwcm9iZV9yZWZsZWN0aW9uIik6DQogICAgICAgIHNjb3JlICs9IDI1DQogICAgaWYgZXZpZGVuY2UuZ2V0KCJwcm9iZV9yZXNwb25zZV9jaGFuZ2UiKToNCiAgICAgICAgc2NvcmUgKz0gMjANCiAgICBzY29yZSArPSBtaW4oZXZpZGVuY2UuZ2V0KCJjdmVfbWF0Y2hlcyIsIDApICogMTUsIDMwKQ0KICAgIGlmIHNjb3JlID4gMTAwOg0KICAgICAgICBzY29yZSA9IDEwMA0KICAgIGlmIHNjb3JlID49IDcwOg0KICAgICAgICBsYWJlbCA9ICJISUdIIg0KICAgIGVsaWYgc2NvcmUgPj0gMzU6DQogICAgICAgIGxhYmVsID0gIk1FRElVTSINCiAgICBlbHNlOg0KICAgICAgICBsYWJlbCA9ICJMT1ciDQogICAgcmV0dXJuIHNjb3JlLCBsYWJlbA0KDQojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMgU2Nhbm5lciAod2l0aCBwYXJhbGxlbCBjcmF3bCkNCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KY2xhc3MgUHJvZmVzc2lvbmFsU2Nhbm5lcjoNCiAgICBkZWYgX19pbml0X18oc2VsZiwgdGFyZ2V0LCBtYXhfcGFnZXM9TUFYX1BBR0VTX0RFRkFVTFQsIGRlbGF5PVBPTElURV9ERUxBWSwNCiAgICAgICAgICAgICAgICAgcHJvYmU9RmFsc2UsIGN2ZV9kYj1Ob25lLCB2ZXJib3NlPUZhbHNlLCBwYXJhbGxlbF93b3JrZXJzPTApOg0KICAgICAgICBzZWxmLnRhcmdldCA9IHRhcmdldC5yc3RyaXAoIi8iKQ0KICAgICAgICBzZWxmLmJhc2UgPSBzZWxmLl9ub3JtYWxpemUoc2VsZi50YXJnZXQpDQogICAgICAgIHNlbGYubWF4X3BhZ2VzID0gbWF4X3BhZ2VzDQogICAgICAgIHNlbGYuZGVsYXkgPSBkZWxheQ0KICAgICAgICBzZWxmLnByb2JlID0gcHJvYmUNCiAgICAgICAgc2VsZi5jdmVfZGIgPSBjdmVfZGIgb3Ige30NCiAgICAgICAgc2VsZi52ZXJib3NlID0gdmVyYm9zZQ0KICAgICAgICBzZWxmLnBhcmFsbGVsX3dvcmtlcnMgPSBwYXJhbGxlbF93b3JrZXJzIGlmIGlzaW5zdGFuY2UocGFyYWxsZWxfd29ya2VycywgaW50KSBhbmQgcGFyYWxsZWxfd29ya2VycyA+IDAgZWxzZSAwDQoNCiAgICAgICAgIyBzdGF0ZQ0KICAgICAgICBzZWxmLnF1ZXVlID0gZGVxdWUoW3NlbGYudGFyZ2V0XSkNCiAgICAgICAgc2VsZi52aXNpdGVkID0gc2V0KCkNCiAgICAgICAgc2VsZi5wYWdlcyA9IHt9ICAjIHVybCAtPiBib2R5DQogICAgICAgIHNlbGYuaGVhZGVycyA9IHt9DQogICAgICAgIHNlbGYucGFyYW1zX21hcCA9IGRlZmF1bHRkaWN0KHNldCkNCiAgICAgICAgc2VsZi5wYXJhbV9leGFtcGxlcyA9IGRlZmF1bHRkaWN0KHNldCkNCiAgICAgICAgc2VsZi5mb3JtcyA9IFtdDQogICAgICAgIHNlbGYuY21zID0ge30NCiAgICAgICAgc2VsZi5leHBvc2VkX2ZpbGVzID0ge30NCiAgICAgICAgc2VsZi5vcGVuX2RpcnMgPSBbXQ0KICAgICAgICBzZWxmLmZpbmRpbmdzID0gW10NCiAgICAgICAgc2VsZi5zZW5zaXRpdmUgPSBkZWZhdWx0ZGljdChsaXN0KQ0KICAgICAgICBzZWxmLnBhc3NpdmVfZXJyb3JzID0ge30NCiAgICAgICAgc2VsZi5fbG9jayA9IHRocmVhZGluZy5Mb2NrKCkNCiAgICAgICAgc2VsZi5zdGF0cyA9IHsiZmV0Y2hlZCI6IDAsICJxdWV1ZWQiOiAxfQ0KDQogICAgZGVmIF9ub3JtYWxpemUoc2VsZiwgdXJsKToNCiAgICAgICAgcCA9IHVybHBhcnNlKHVybCkNCiAgICAgICAgc2NoZW1lID0gcC5zY2hlbWUgb3IgImh0dHAiDQogICAgICAgIGhvc3QgPSBwLm5ldGxvYyBvciBwLnBhdGgNCiAgICAgICAgcmV0dXJuIGYie3NjaGVtZX06Ly97aG9zdH0iDQoNCiAgICBkZWYgbG9nKHNlbGYsICphKToNCiAgICAgICAgaWYgc2VsZi52ZXJib3NlOg0KICAgICAgICAgICAgcHJpbnQoIlsqXSIsICphKQ0KDQogICAgZGVmIF9mZXRjaF93b3JrZXIoc2VsZik6DQogICAgICAgICIiIldvcmtlciB1c2VkIGluIHRocmVhZGVkIGNyYXdsaW5nLiIiIg0KICAgICAgICB3aGlsZSBUcnVlOg0KICAgICAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLnF1ZXVlIG9yIGxlbihzZWxmLnZpc2l0ZWQpID49IHNlbGYubWF4X3BhZ2VzOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgICAgICB1cmwgPSBzZWxmLnF1ZXVlLnBvcGxlZnQoKQ0KICAgICAgICAgICAgaWYgdXJsIGluIHNlbGYudmlzaXRlZDoNCiAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgc2VsZi5sb2coIkdFVCIsIHVybCkNCiAgICAgICAgICAgIHIgPSBzYWZlX2dldCh1cmwpDQogICAgICAgICAgICB0aW1lLnNsZWVwKHNlbGYuZGVsYXkpDQogICAgICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICAgICAgc2VsZi52aXNpdGVkLmFkZCh1cmwpDQogICAgICAgICAgICAgICAgc2VsZi5zdGF0c1siZmV0Y2hlZCJdICs9IDENCiAgICAgICAgICAgIGlmIG5vdCByOg0KICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICBib2R5ID0gci50ZXh0IG9yICIiDQogICAgICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICAgICAgc2VsZi5wYWdlc1t1cmxdID0gYm9keQ0KICAgICAgICAgICAgICAgIHNlbGYuaGVhZGVyc1t1cmxdID0gZGljdChyLmhlYWRlcnMpDQogICAgICAgICAgICBzZWxmLl9maW5nZXJwcmludChib2R5LCB1cmwpDQogICAgICAgICAgICBzZWxmLl9wYXJzZV9wYWdlKGJvZHksIHVybCkNCg0KICAgIGRlZiBjcmF3bChzZWxmKToNCiAgICAgICAgIiIiQ3Jhd2wgZWl0aGVyIHNpbmdsZS10aHJlYWRlZCBvciB3aXRoIHRocmVhZHMgZGVwZW5kaW5nIG9uIHBhcmFsbGVsX3dvcmtlcnMuIiIiDQogICAgICAgIGlmIHNlbGYucGFyYWxsZWxfd29ya2VycyBhbmQgc2VsZi5wYXJhbGxlbF93b3JrZXJzID4gMToNCiAgICAgICAgICAgICMgc3RhcnQgdGhyZWFkcG9vbA0KICAgICAgICAgICAgd29ya2VycyA9IG1pbihzZWxmLnBhcmFsbGVsX3dvcmtlcnMsIDMwKQ0KICAgICAgICAgICAgaWYgQ09MT1JfRU5BQkxFRDoNCiAgICAgICAgICAgICAgICBwcmludChjb2xvcihmIlsqXSBTdGFydGluZyBwYXJhbGxlbCBjcmF3bCB3aXRoIHt3b3JrZXJzfSB3b3JrZXJzLi4uIiwgRm9yZS5DWUFOKSkNCiAgICAgICAgICAgIHRocmVhZHMgPSBbXQ0KICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2Uod29ya2Vycyk6DQogICAgICAgICAgICAgICAgdCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbGYuX2ZldGNoX3dvcmtlciwgZGFlbW9uPVRydWUpDQogICAgICAgICAgICAgICAgdC5zdGFydCgpDQogICAgICAgICAgICAgICAgdGhyZWFkcy5hcHBlbmQodCkNCiAgICAgICAgICAgIGZvciB0IGluIHRocmVhZHM6DQogICAgICAgICAgICAgICAgdC5qb2luKCkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgICMgc2luZ2xlLXRocmVhZGVkIGNyYXdsaW5nDQogICAgICAgICAgICB3aGlsZSBzZWxmLnF1ZXVlIGFuZCBsZW4oc2VsZi52aXNpdGVkKSA8IHNlbGYubWF4X3BhZ2VzOg0KICAgICAgICAgICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgICAgICAgICAgdXJsID0gc2VsZi5xdWV1ZS5wb3BsZWZ0KCkNCiAgICAgICAgICAgICAgICBpZiB1cmwgaW4gc2VsZi52aXNpdGVkOg0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgICAgIHNlbGYubG9nKCJHRVQiLCB1cmwpDQogICAgICAgICAgICAgICAgciA9IHNhZmVfZ2V0KHVybCkNCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKHNlbGYuZGVsYXkpDQogICAgICAgICAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgICAgICAgICBzZWxmLnZpc2l0ZWQuYWRkKHVybCkNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zdGF0c1siZmV0Y2hlZCJdICs9IDENCiAgICAgICAgICAgICAgICBpZiBub3QgcjoNCiAgICAgICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgICAgICBib2R5ID0gci50ZXh0IG9yICIiDQogICAgICAgICAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgICAgICAgICBzZWxmLnBhZ2VzW3VybF0gPSBib2R5DQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGVhZGVyc1t1cmxdID0gZGljdChyLmhlYWRlcnMpDQogICAgICAgICAgICAgICAgc2VsZi5fZmluZ2VycHJpbnQoYm9keSwgdXJsKQ0KICAgICAgICAgICAgICAgIHNlbGYuX3BhcnNlX3BhZ2UoYm9keSwgdXJsKQ0KDQogICAgZGVmIF9maW5nZXJwcmludChzZWxmLCBib2R5LCB1cmwpOg0KICAgICAgICBpZiAid3AtY29udGVudCIgaW4gYm9keToNCiAgICAgICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgICAgICBzZWxmLmNtcy5zZXRkZWZhdWx0KCJ3b3JkcHJlc3MiLCBbXSkuYXBwZW5kKHVybCkNCiAgICAgICAgaWYgIkpvb21sYSEiIGluIGJvZHkgb3IgImNvbV9jb250ZW50IiBpbiBib2R5Og0KICAgICAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgICAgIHNlbGYuY21zLnNldGRlZmF1bHQoImpvb21sYSIsIFtdKS5hcHBlbmQodXJsKQ0KICAgICAgICBpZiAiRHJ1cGFsLnNldHRpbmdzIiBpbiBib2R5IG9yICJkcnVwYWwiIGluIGJvZHkubG93ZXIoKToNCiAgICAgICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgICAgICBzZWxmLmNtcy5zZXRkZWZhdWx0KCJkcnVwYWwiLCBbXSkuYXBwZW5kKHVybCkNCg0KICAgIGRlZiBfcGFyc2VfcGFnZShzZWxmLCBib2R5LCB1cmwpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBzb3VwID0gQmVhdXRpZnVsU291cChib2R5LCAiaHRtbC5wYXJzZXIiKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uOg0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIGZvciBhIGluIHNvdXAuZmluZF9hbGwoImEiLCBocmVmPVRydWUpOg0KICAgICAgICAgICAgaHJlZiA9IGFbJ2hyZWYnXS5zdHJpcCgpDQogICAgICAgICAgICBmdWxsID0gdXJsam9pbih1cmwsIGhyZWYpDQogICAgICAgICAgICBpZiB1cmxwYXJzZShmdWxsKS5uZXRsb2MgPT0gdXJscGFyc2Uoc2VsZi5iYXNlKS5uZXRsb2M6DQogICAgICAgICAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgICAgICAgICBpZiBmdWxsIG5vdCBpbiBzZWxmLnZpc2l0ZWQgYW5kIGZ1bGwgbm90IGluIHNlbGYucXVldWUgYW5kIGxlbihzZWxmLnZpc2l0ZWQpICsgbGVuKHNlbGYucXVldWUpIDwgc2VsZi5tYXhfcGFnZXM6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgcmUuc2VhcmNoKHIiXC4ocG5nfGpwZ3xqcGVnfGdpZnxzdmd8aWNvfGNzc3x3b2ZmfHdvZmYyfHBkZnx6aXApJCIsIGZ1bGwsIHJlLkkpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucXVldWUuYXBwZW5kKGZ1bGwpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zdGF0c1sicXVldWVkIl0gKz0gMQ0KICAgICAgICAgICAgcSA9IHVybHBhcnNlKGZ1bGwpLnF1ZXJ5DQogICAgICAgICAgICBpZiBxOg0KICAgICAgICAgICAgICAgIHFzID0gcGFyc2VfcXMocSkNCiAgICAgICAgICAgICAgICBmb3IgaywgdiBpbiBxcy5pdGVtcygpOg0KICAgICAgICAgICAgICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBhcmFtc19tYXBba10uYWRkKGZ1bGwpDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgZXggaW4gdjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBleDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wYXJhbV9leGFtcGxlc1trXS5hZGQoZXgpDQogICAgICAgIGZvciBmb3JtIGluIHNvdXAuZmluZF9hbGwoImZvcm0iKToNCiAgICAgICAgICAgIGZkZXQgPSB7ImFjdGlvbiI6IGZvcm0uZ2V0KCJhY3Rpb24iKSwgIm1ldGhvZCI6IChmb3JtLmdldCgibWV0aG9kIikgb3IgIkdFVCIpLnVwcGVyKCksICJpbnB1dHMiOiBbXX0NCiAgICAgICAgICAgIGZvciBpbnAgaW4gZm9ybS5maW5kX2FsbChbImlucHV0IiwgInRleHRhcmVhIiwgInNlbGVjdCJdKToNCiAgICAgICAgICAgICAgICBuYW1lID0gaW5wLmdldCgibmFtZSIpDQogICAgICAgICAgICAgICAgaXR5cGUgPSBpbnAuZ2V0KCJ0eXBlIikgb3IgaW5wLm5hbWUNCiAgICAgICAgICAgICAgICBpZiBuYW1lOg0KICAgICAgICAgICAgICAgICAgICBmZGV0WyJpbnB1dHMiXS5hcHBlbmQoeyJuYW1lIjogbmFtZSwgInR5cGUiOiBpdHlwZX0pDQogICAgICAgICAgICAgICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGFyYW1zX21hcFtuYW1lXS5hZGQodXJsKQ0KICAgICAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgICAgIHNlbGYuZm9ybXMuYXBwZW5kKGZkZXQpDQogICAgICAgIHRleHQgPSBzb3VwLmdldF90ZXh0KCIgIiwgc3RyaXA9VHJ1ZSkNCiAgICAgICAgZm9yIHBhdHQgaW4gU0VOU0lUSVZFX1BBVFRFUk5TOg0KICAgICAgICAgICAgZm9yIG0gaW4gcmUuZmluZGl0ZXIocGF0dCwgdGV4dCwgcmUuSSk6DQogICAgICAgICAgICAgICAgc25pcHBldCA9IHRleHRbbWF4KDAsIG0uc3RhcnQoKSAtIDYwKTogbS5lbmQoKSArIDYwXQ0KICAgICAgICAgICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZW5zaXRpdmVbdXJsXS5hcHBlbmQoc25pcHBldCkNCg0KICAgIGRlZiBjaGVja19jb21tb25fZmlsZXMoc2VsZik6DQogICAgICAgIGJhc2UgPSBzZWxmLmJhc2UgKyAiLyINCiAgICAgICAgZm9yIGYgaW4gQ09NTU9OX0ZJTEVTOg0KICAgICAgICAgICAgdXJsID0gdXJsam9pbihiYXNlLCBmKQ0KICAgICAgICAgICAgc2VsZi5sb2coIkNoZWNraW5nIGZpbGUiLCB1cmwpDQogICAgICAgICAgICByID0gc2FmZV9nZXQodXJsKQ0KICAgICAgICAgICAgdGltZS5zbGVlcChzZWxmLmRlbGF5KQ0KICAgICAgICAgICAgaWYgciBhbmQgci5zdGF0dXNfY29kZSA9PSAyMDA6DQogICAgICAgICAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cG9zZWRfZmlsZXNbdXJsXSA9IHsic3RhdHVzIjogci5zdGF0dXNfY29kZSwgImxlbiI6IGxlbihyLmNvbnRlbnQpfQ0KDQogICAgZGVmIGRldGVjdF9vcGVuX2RpcnMoc2VsZik6DQogICAgICAgIGNhbmRpZGF0ZXMgPSBzZXQoKQ0KICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICBwYWdlc19jb3B5ID0gbGlzdChzZWxmLnBhZ2VzLmtleXMoKSkNCiAgICAgICAgZm9yIHUgaW4gcGFnZXNfY29weToNCiAgICAgICAgICAgIHAgPSB1cmxwYXJzZSh1KS5wYXRoDQogICAgICAgICAgICBpZiBwLmVuZHN3aXRoKCIvIik6DQogICAgICAgICAgICAgICAgY2FuZGlkYXRlcy5hZGQodXJsam9pbihzZWxmLmJhc2UsIHApKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBkaXJwID0gIi8iLmpvaW4ocC5zcGxpdCgiLyIpWzotMV0pICsgIi8iDQogICAgICAgICAgICAgICAgaWYgZGlycCBhbmQgZGlycCAhPSAiLyI6DQogICAgICAgICAgICAgICAgICAgIGNhbmRpZGF0ZXMuYWRkKHVybGpvaW4oc2VsZi5iYXNlLCBkaXJwKSkNCiAgICAgICAgZm9yIGMgaW4gbGlzdChjYW5kaWRhdGVzKVs6MjAwXToNCiAgICAgICAgICAgIHNlbGYubG9nKCJDaGVja2luZyBvcGVuIGRpciIsIGMpDQogICAgICAgICAgICByID0gc2FmZV9nZXQoYykNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoc2VsZi5kZWxheSkNCiAgICAgICAgICAgIGlmIHIgYW5kIHIuc3RhdHVzX2NvZGUgPT0gMjAwIGFuZCByZS5zZWFyY2gociJJbmRleCBvZiAvfFBhcmVudCBEaXJlY3RvcnkiLCByLnRleHQsIHJlLkkpOg0KICAgICAgICAgICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuX2RpcnMuYXBwZW5kKGMpDQoNCiAgICBkZWYgcGFzc2l2ZV9lcnJvcl9zY2FuKHNlbGYpOg0KICAgICAgICBwYXNzaXZlX2Vycm9ycyA9IHt9DQogICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgIHBhZ2VzX2NvcHkgPSBkaWN0KHNlbGYucGFnZXMpDQogICAgICAgIGZvciB1cmwsIGJvZHkgaW4gcGFnZXNfY29weS5pdGVtcygpOg0KICAgICAgICAgICAgZm9yIG5hbWUsIHBhdHRlcm5zIGluIEVSUk9SX1NJR05BVFVSRVMuaXRlbXMoKToNCiAgICAgICAgICAgICAgICBmb3IgcGF0dCBpbiBwYXR0ZXJuczoNCiAgICAgICAgICAgICAgICAgICAgaWYgcmUuc2VhcmNoKHBhdHQsIGJvZHksIHJlLkkpOg0KICAgICAgICAgICAgICAgICAgICAgICAgcGFzc2l2ZV9lcnJvcnMuc2V0ZGVmYXVsdCh1cmwsIFtdKS5hcHBlbmQoeyJ0eXBlIjogbmFtZSwgInBhdHRlcm4iOiBwYXR0fSkNCiAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgc2VsZi5wYXNzaXZlX2Vycm9ycyA9IHBhc3NpdmVfZXJyb3JzDQogICAgICAgIHJldHVybiBwYXNzaXZlX2Vycm9ycw0KDQogICAgZGVmIGFuYWx5emVfcGFyYW1zKHNlbGYpOg0KICAgICAgICBzZWxmLnBhc3NpdmVfZXJyb3Jfc2NhbigpDQogICAgICAgIGZpbmRpbmdzID0gW10NCiAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgcGFyYW1zX2l0ZW1zID0gbGlzdChzZWxmLnBhcmFtc19tYXAuaXRlbXMoKSkNCiAgICAgICAgICAgIGV4cG9zZWRfY291bnQgPSBsZW4oc2VsZi5leHBvc2VkX2ZpbGVzKQ0KICAgICAgICAgICAgY21zX2tleXMgPSBsaXN0KHNlbGYuY21zLmtleXMoKSkNCiAgICAgICAgZm9yIHBhcmFtLCB1cmxzIGluIHBhcmFtc19pdGVtczoNCiAgICAgICAgICAgIGV2aWRlbmNlID0gew0KICAgICAgICAgICAgICAgICJwYXJhbSI6IHBhcmFtLA0KICAgICAgICAgICAgICAgICJzZWVuX2luIjogbGlzdCh1cmxzKVs6MTJdLA0KICAgICAgICAgICAgICAgICJwYXJhbV9uYW1lX2hldXJpc3RpYyI6IDAsDQogICAgICAgICAgICAgICAgInBhc3NpdmVfZXJyb3IiOiBGYWxzZSwNCiAgICAgICAgICAgICAgICAiZXhwb3NlZF9maWxlIjogZXhwb3NlZF9jb3VudCwNCiAgICAgICAgICAgICAgICAicmVmbGVjdGlvbl9wYXNzaXZlIjogMCwNCiAgICAgICAgICAgICAgICAicHJvYmVfcmVmbGVjdGlvbiI6IE5vbmUsDQogICAgICAgICAgICAgICAgInByb2JlX3Jlc3BvbnNlX2NoYW5nZSI6IE5vbmUsDQogICAgICAgICAgICAgICAgImN2ZV9tYXRjaGVzIjogMCwNCiAgICAgICAgICAgICAgICAiY3ZlX2xpc3QiOiBbXSwNCiAgICAgICAgICAgICAgICAibm90ZXMiOiBbXQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbG93ID0gcGFyYW0ubG93ZXIoKQ0KICAgICAgICAgICAgZm9yIGZyYWcgaW4gSEVVUklTVElDX01BUC5rZXlzKCk6DQogICAgICAgICAgICAgICAgaWYgZnJhZyBpbiBsb3c6DQogICAgICAgICAgICAgICAgICAgIGV2aWRlbmNlWyJwYXJhbV9uYW1lX2hldXJpc3RpYyJdICs9IDENCiAgICAgICAgICAgICAgICAgICAgZXZpZGVuY2VbIm5vdGVzIl0uYXBwZW5kKGYiaGV1cmlzdGljX21hdGNoOntmcmFnfSIpDQogICAgICAgICAgICBleGFtcGxlcyA9IGxpc3Qoc2VsZi5wYXJhbV9leGFtcGxlcy5nZXQocGFyYW0sIFtdKSlbOjVdDQogICAgICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICAgICAgcGFnZXNfY29weSA9IGRpY3Qoc2VsZi5wYWdlcykNCiAgICAgICAgICAgIGZvciBleCBpbiBleGFtcGxlczoNCiAgICAgICAgICAgICAgICBpZiBub3QgZXg6DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICAgICAgZXhfZXNjID0gcmUuZXNjYXBlKGV4KQ0KICAgICAgICAgICAgICAgIGZvciBwdXJsLCBib2R5IGluIHBhZ2VzX2NvcHkuaXRlbXMoKToNCiAgICAgICAgICAgICAgICAgICAgaWYgcmUuc2VhcmNoKGV4X2VzYywgYm9keSwgcmUuSUdOT1JFQ0FTRSk6DQogICAgICAgICAgICAgICAgICAgICAgICBldmlkZW5jZVsicmVmbGVjdGlvbl9wYXNzaXZlIl0gKz0gMQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXZpZGVuY2VbIm5vdGVzIl0uYXBwZW5kKGYicGFzc2l2ZV9yZWZsZWN0aW9uX2V4YW1wbGU6e2V4fSBvbiB7cHVybH0iKQ0KICAgICAgICAgICAgZm9yIHB1cmwsIGVycnMgaW4gc2VsZi5wYXNzaXZlX2Vycm9ycy5pdGVtcygpOg0KICAgICAgICAgICAgICAgIGlmIGFueShwdXJsID09IHUgb3IgcHVybCBpbiB1IGZvciB1IGluIHVybHMpOg0KICAgICAgICAgICAgICAgICAgICBldmlkZW5jZVsicGFzc2l2ZV9lcnJvciJdID0gVHJ1ZQ0KICAgICAgICAgICAgICAgICAgICBldmlkZW5jZVsibm90ZXMiXS5hcHBlbmQoZiJlcnJvcl9zaWduYXR1cmVfb246e3B1cmx9IikNCiAgICAgICAgICAgICMgQ1ZFIG1hdGNoaW5nIHZpYSBjdmVfZGINCiAgICAgICAgICAgIGlmIHNlbGYuY3ZlX2RiIGFuZCBzZWxmLmNtczoNCiAgICAgICAgICAgICAgICBmb3IgY21zX25hbWUgaW4gY21zX2tleXM6DQogICAgICAgICAgICAgICAgICAgIGlmIGNtc19uYW1lIGluIHNlbGYuY3ZlX2RiOg0KICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHNlbGYuY3ZlX2RiLmdldChjbXNfbmFtZSwgW10pDQogICAgICAgICAgICAgICAgICAgICAgICBldmlkZW5jZVsiY3ZlX21hdGNoZXMiXSArPSBsZW4obWF0Y2hlcykNCiAgICAgICAgICAgICAgICAgICAgICAgIGV2aWRlbmNlWyJjdmVfbGlzdCJdLmV4dGVuZChtYXRjaGVzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXZpZGVuY2VbIm5vdGVzIl0uYXBwZW5kKGYiY3ZlX2RiX21hdGNoOntjbXNfbmFtZX0iKQ0KICAgICAgICAgICAgZmluZGluZ3MuYXBwZW5kKHsicGFyYW0iOiBwYXJhbSwgImV2aWRlbmNlIjogZXZpZGVuY2V9KQ0KICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICBzZWxmLmZpbmRpbmdzID0gZmluZGluZ3MNCiAgICAgICAgcmV0dXJuIGZpbmRpbmdzDQoNCiAgICBkZWYgcnVuX3Byb2JlcyhzZWxmKToNCiAgICAgICAgaWYgbm90IHNlbGYucHJvYmU6DQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgd2l0aCBzZWxmLl9sb2NrOg0KICAgICAgICAgICAgZmluZGluZ3NfY29weSA9IGxpc3Qoc2VsZi5maW5kaW5ncykNCiAgICAgICAgZm9yIGYgaW4gZmluZGluZ3NfY29weToNCiAgICAgICAgICAgIHBhcmFtID0gZlsicGFyYW0iXQ0KICAgICAgICAgICAgc2VlbiA9IGZbImV2aWRlbmNlIl1bInNlZW5faW4iXQ0KICAgICAgICAgICAgaWYgbm90IHNlZW46DQogICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgIHNhbXBsZV91cmwgPSBzZWVuWzBdDQogICAgICAgICAgICBwYXJzZWQgPSB1cmxwYXJzZShzYW1wbGVfdXJsKQ0KICAgICAgICAgICAgcXMgPSBwYXJzZV9xcyhwYXJzZWQucXVlcnkpDQogICAgICAgICAgICBwcm9iZV90b2tlbiA9IHJhbmRvbV90b2tlbigiUFJCIikNCiAgICAgICAgICAgIHFzW3BhcmFtXSA9IFtwcm9iZV90b2tlbl0NCiAgICAgICAgICAgIGJhc2UgPSBwYXJzZWQuX3JlcGxhY2UocXVlcnk9IiIpLmdldHVybCgpDQogICAgICAgICAgICBzZWxmLmxvZygiUHJvYmluZyIsIGJhc2UsICJwYXJhbSIsIHBhcmFtLCAidG9rZW4iLCBwcm9iZV90b2tlbikNCiAgICAgICAgICAgIHIgPSBzYWZlX2dldChiYXNlLCBwYXJhbXM9e2s6IHZbMF0gZm9yIGssIHYgaW4gcXMuaXRlbXMoKX0pDQogICAgICAgICAgICB0aW1lLnNsZWVwKHNlbGYuZGVsYXkpDQogICAgICAgICAgICBpZiBub3QgcjoNCiAgICAgICAgICAgICAgICBmWyJldmlkZW5jZSJdWyJwcm9iZV9yZWZsZWN0aW9uIl0gPSBGYWxzZQ0KICAgICAgICAgICAgICAgIGZbImV2aWRlbmNlIl1bInByb2JlX3Jlc3BvbnNlX2NoYW5nZSJdID0gRmFsc2UNCiAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgaWYgcHJvYmVfdG9rZW4gaW4gKHIudGV4dCBvciAiIik6DQogICAgICAgICAgICAgICAgZlsiZXZpZGVuY2UiXVsicHJvYmVfcmVmbGVjdGlvbiJdID0gVHJ1ZQ0KICAgICAgICAgICAgICAgIGZbImV2aWRlbmNlIl1bIm5vdGVzIl0uYXBwZW5kKGYicHJvYmVfcmVmbGVjdGVkX29uOntiYXNlfSIpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGZbImV2aWRlbmNlIl1bInByb2JlX3JlZmxlY3Rpb24iXSA9IEZhbHNlDQogICAgICAgICAgICBvcmlnX2JvZHkgPSBOb25lDQogICAgICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICAgICAgb3JpZ19ib2R5ID0gc2VsZi5wYWdlcy5nZXQoYmFzZSwgIiIpDQogICAgICAgICAgICBuZXdfYm9keSA9IHIudGV4dCBvciAiIg0KICAgICAgICAgICAgaWYgb3JpZ19ib2R5Og0KICAgICAgICAgICAgICAgIHNlcSA9IGRpZmZsaWIuU2VxdWVuY2VNYXRjaGVyKGE9b3JpZ19ib2R5LCBiPW5ld19ib2R5KQ0KICAgICAgICAgICAgICAgIHJhdGlvID0gc2VxLnF1aWNrX3JhdGlvKCkNCiAgICAgICAgICAgICAgICBpZiByYXRpbyA8IDAuOTg6DQogICAgICAgICAgICAgICAgICAgIGZbImV2aWRlbmNlIl1bInByb2JlX3Jlc3BvbnNlX2NoYW5nZSJdID0gVHJ1ZQ0KICAgICAgICAgICAgICAgICAgICBmWyJldmlkZW5jZSJdWyJub3RlcyJdLmFwcGVuZChmInByb2JlX3Jlc3BvbnNlX3JhdGlvOntyYXRpbzouM2Z9IikNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBmWyJldmlkZW5jZSJdWyJwcm9iZV9yZXNwb25zZV9jaGFuZ2UiXSA9IEZhbHNlDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGZbImV2aWRlbmNlIl1bInByb2JlX3Jlc3BvbnNlX2NoYW5nZSJdID0gTm9uZQ0KDQogICAgZGVmIGZpbmFsaXplX2ZpbmRpbmdzKHNlbGYpOg0KICAgICAgICBmaW5hbGl6ZWQgPSBbXQ0KICAgICAgICB3aXRoIHNlbGYuX2xvY2s6DQogICAgICAgICAgICBmaW5kaW5nc19jb3B5ID0gbGlzdChzZWxmLmZpbmRpbmdzKQ0KICAgICAgICBmb3IgZiBpbiBmaW5kaW5nc19jb3B5Og0KICAgICAgICAgICAgZXYgPSBmWyJldmlkZW5jZSJdDQogICAgICAgICAgICAjIGluY2x1ZGUgY3ZlX2xpc3QgaW4gZXZpZGVuY2UgaWYgcHJlc2VudA0KICAgICAgICAgICAgaWYgZXYuZ2V0KCJjdmVfbGlzdCIpOg0KICAgICAgICAgICAgICAgIGV2WyJub3RlcyJdLmFwcGVuZCgiY3ZlX21hdGNoZXM6IiArICIsIi5qb2luKGV2LmdldCgiY3ZlX2xpc3QiLCBbXSlbOjVdKSkNCiAgICAgICAgICAgIHNjb3JlLCBsYWJlbCA9IGNvbXB1dGVfc2NvcmUoZXYpDQogICAgICAgICAgICByZW1lZGlhdGlvbiA9IHNlbGYuc3VnZ2VzdF9yZW1lZGlhdGlvbihldikNCiAgICAgICAgICAgIGZpbmFsaXplZC5hcHBlbmQoew0KICAgICAgICAgICAgICAgICJwYXJhbSI6IGZbInBhcmFtIl0sDQogICAgICAgICAgICAgICAgInNlZW5faW4iOiBldlsic2Vlbl9pbiJdLA0KICAgICAgICAgICAgICAgICJldmlkZW5jZSI6IGV2LA0KICAgICAgICAgICAgICAgICJzY29yZSI6IHNjb3JlLA0KICAgICAgICAgICAgICAgICJjb25maWRlbmNlIjogbGFiZWwsDQogICAgICAgICAgICAgICAgInJlbWVkaWF0aW9uIjogcmVtZWRpYXRpb24NCiAgICAgICAgICAgIH0pDQogICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgIHNlbGYuZmluZGluZ3MgPSBmaW5hbGl6ZWQNCiAgICAgICAgcmV0dXJuIGZpbmFsaXplZA0KDQogICAgZGVmIHN1Z2dlc3RfcmVtZWRpYXRpb24oc2VsZiwgZXYpOg0KICAgICAgICByZW0gPSBbXQ0KICAgICAgICBpZiBldi5nZXQoInBhcmFtX25hbWVfaGV1cmlzdGljIiwgMCkgPiAwOg0KICAgICAgICAgICAgcmVtLmFwcGVuZCgiUmV2aWV3IGhvdyB0aGlzIHBhcmFtZXRlciBpcyB1c2VkIHNlcnZlci1zaWRlOyBlbmZvcmNlIHN0cmljdCB0eXBpbmcgJiB3aGl0ZWxpc3QgdmFsdWVzLiIpDQogICAgICAgIGlmIGV2LmdldCgicGFzc2l2ZV9lcnJvciIpOg0KICAgICAgICAgICAgcmVtLmFwcGVuZCgiRGlzYWJsZSBkZXRhaWxlZCBlcnJvciBtZXNzYWdlcyBpbiBwcm9kdWN0aW9uOyBzYW5pdGl6ZSBlcnJvciBvdXRwdXRzLiIpDQogICAgICAgIGlmIGV2LmdldCgicmVmbGVjdGlvbl9wYXNzaXZlIikgb3IgZXYuZ2V0KCJwcm9iZV9yZWZsZWN0aW9uIik6DQogICAgICAgICAgICByZW0uYXBwZW5kKCJBcHBseSBwcm9wZXIgb3V0cHV0IGVuY29kaW5nIGFuZCBhIHN0cmljdCBDb250ZW50LVNlY3VyaXR5LVBvbGljeSAoQ1NQKS4iKQ0KICAgICAgICBpZiBldi5nZXQoInByb2JlX3Jlc3BvbnNlX2NoYW5nZSIpOg0KICAgICAgICAgICAgcmVtLmFwcGVuZCgiUGFyYW1ldGVyIGFsdGVycyByZW5kZXJpbmcg4oCUIHVzZSBwcmVwYXJlZCBzdGF0ZW1lbnRzIGFuZCBzdHJpY3QgdmFsaWRhdGlvbi4iKQ0KICAgICAgICBpZiBldi5nZXQoImV4cG9zZWRfZmlsZSIsIDApID4gMDoNCiAgICAgICAgICAgIHJlbS5hcHBlbmQoIlJlbW92ZSBvciBwcm90ZWN0IGJhY2t1cC9jb25maWcgZmlsZXM7IGRpc2FibGUgZGlyZWN0b3J5IGxpc3Rpbmc7IHRpZ2h0ZW4gZmlsZSBwZXJtcy4iKQ0KICAgICAgICBpZiBldi5nZXQoImN2ZV9saXN0Iik6DQogICAgICAgICAgICByZW0uYXBwZW5kKCJQYXRjaCBhZmZlY3RlZCBDTVMvcGx1Z2lucyBwZXIgQ1ZFIGFkdmlzb3JpZXMgbGlzdGVkLiIpDQogICAgICAgIGlmIG5vdCByZW06DQogICAgICAgICAgICByZW0uYXBwZW5kKCJHZW5lcmFsIGhhcmRlbmluZzogaW5wdXQgdmFsaWRhdGlvbiwgbGVhc3QgcHJpdmlsZWdlLCBXQUYsIHJhdGUtbGltaXRpbmcgYW5kIG1vbml0b3JpbmcuIikNCiAgICAgICAgcmV0dXJuIHJlbQ0KDQogICAgZGVmIGVudW1lcmF0ZV9zdWJkb21haW5zKHNlbGYsIHdvcmRsaXN0PU5vbmUsIHdvcmtlcnM9MTApOg0KICAgICAgICBob3N0ID0gdXJscGFyc2Uoc2VsZi5iYXNlKS5uZXRsb2MNCiAgICAgICAgaWYgIjoiIGluIGhvc3Q6DQogICAgICAgICAgICBob3N0ID0gaG9zdC5zcGxpdCgiOiIpWzBdDQogICAgICAgIHdvcmRzID0gd29yZGxpc3Qgb3IgWyJ3d3ciLCAiZGV2IiwgInRlc3QiLCAic3RhZ2luZyIsICJiZXRhIiwgImFkbWluIiwgImFwaSIsICJtIiwgIm1haWwiLCAicG9ydGFsIl0NCiAgICAgICAgcmVzdWx0cyA9IHt9DQogICAgICAgIGRlZiByZXNvbHZlKG5hbWUpOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlwID0gc29ja2V0LmdldGhvc3RieW5hbWUobmFtZSkNCiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZSwgaXANCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246DQogICAgICAgICAgICAgICAgcmV0dXJuIG5hbWUsIE5vbmUNCiAgICAgICAgd2l0aCBUaHJlYWRQb29sRXhlY3V0b3IobWF4X3dvcmtlcnM9d29ya2VycykgYXMgZXg6DQogICAgICAgICAgICBmdXR1cmVzID0ge2V4LnN1Ym1pdChyZXNvbHZlLCBmInt3fS57aG9zdH0iKTogdyBmb3IgdyBpbiB3b3Jkc30NCiAgICAgICAgICAgIGZvciBmdXQgaW4gYXNfY29tcGxldGVkKGZ1dHVyZXMpOg0KICAgICAgICAgICAgICAgIG5hbWUsIGlwID0gZnV0LnJlc3VsdCgpDQogICAgICAgICAgICAgICAgaWYgaXA6DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdHNbbmFtZV0gPSBpcA0KICAgICAgICByZXR1cm4gcmVzdWx0cw0KDQogICAgZGVmIGV4cG9ydF9yZXBvcnQoc2VsZik6DQogICAgICAgIGRvbWFpbiA9IGRvbWFpbl9zYWZlX25hbWUoc2VsZi5iYXNlKQ0KICAgICAgICB0cyA9IGRhdGV0aW1lLnV0Y25vdygpLnN0cmZ0aW1lKCIlWSVtJWRUJUglTSVTWiIpDQogICAgICAgIGpzb25fcGF0aCA9IG9zLnBhdGguam9pbihSRVBPUlRTX0RJUiwgZiJ7ZG9tYWlufV97dHN9Lmpzb24iKQ0KICAgICAgICBodG1sX3BhdGggPSBvcy5wYXRoLmpvaW4oUkVQT1JUU19ESVIsIGYie2RvbWFpbn1fe3RzfS5odG1sIikNCiAgICAgICAgcmVwb3J0ID0gT3JkZXJlZERpY3QoKQ0KICAgICAgICByZXBvcnRbInRvb2wiXSA9IFRPT0xfTkFNRQ0KICAgICAgICByZXBvcnRbInZlcnNpb24iXSA9IFZFUlNJT04NCiAgICAgICAgcmVwb3J0WyJkZXZlbG9wZXIiXSA9IERFVkVMT1BFUg0KICAgICAgICByZXBvcnRbInRhcmdldCJdID0gc2VsZi50YXJnZXQNCiAgICAgICAgcmVwb3J0WyJzY2FubmVkX2F0Il0gPSBub3dfdXRjX2lzbygpDQogICAgICAgIHdpdGggc2VsZi5fbG9jazoNCiAgICAgICAgICAgIHJlcG9ydFsic3VtbWFyeSJdID0gew0KICAgICAgICAgICAgICAgICJwYWdlc19jcmF3bGVkIjogbGVuKHNlbGYucGFnZXMpLA0KICAgICAgICAgICAgICAgICJ1bmlxdWVfcGFyYW1zIjogbGVuKHNlbGYucGFyYW1zX21hcCksDQogICAgICAgICAgICAgICAgImZvcm1zIjogbGVuKHNlbGYuZm9ybXMpLA0KICAgICAgICAgICAgICAgICJjbXNfZGV0ZWN0ZWQiOiBzZWxmLmNtcywNCiAgICAgICAgICAgICAgICAiZXhwb3NlZF9maWxlcyI6IGxpc3Qoc2VsZi5leHBvc2VkX2ZpbGVzLmtleXMoKSksDQogICAgICAgICAgICAgICAgIm9wZW5fZGlycyI6IHNlbGYub3Blbl9kaXJzDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXBvcnRbImZpbmRpbmdzIl0gPSBzZWxmLmZpbmRpbmdzDQogICAgICAgICAgICByZXBvcnRbInNlbnNpdGl2ZV9zYW1wbGVzIl0gPSB7azogdls6M10gZm9yIGssIHYgaW4gc2VsZi5zZW5zaXRpdmUuaXRlbXMoKX0NCiAgICAgICAgd2l0aCBvcGVuKGpzb25fcGF0aCwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICAgICAganNvbi5kdW1wKHJlcG9ydCwgZiwgaW5kZW50PTIsIGVuc3VyZV9hc2NpaT1GYWxzZSkNCiAgICAgICAgaHRtbCA9IHNlbGYuX3JlbmRlcl9odG1sKHJlcG9ydCkNCiAgICAgICAgd2l0aCBvcGVuKGh0bWxfcGF0aCwgInciLCBlbmNvZGluZz0idXRmLTgiKSBhcyBmOg0KICAgICAgICAgICAgZi53cml0ZShodG1sKQ0KICAgICAgICByZXR1cm4ganNvbl9wYXRoLCBodG1sX3BhdGgNCg0KICAgIGRlZiBfcmVuZGVyX2h0bWwoc2VsZiwgcmVwb3J0KToNCiAgICAgICAgY3NzID0gIiIiDQogICAgICAgIGJvZHl7Zm9udC1mYW1pbHk6SW50ZXIsU2Vnb2UgVUksQXJpYWwsSGVsdmV0aWNhLHNhbnMtc2VyaWY7bWFyZ2luOjE4cHg7Y29sb3I6IzIyMn0NCiAgICAgICAgaGVhZGVye2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjIwcHh9DQogICAgICAgIGgxe21hcmdpbjowfQ0KICAgICAgICAubWV0YXtjb2xvcjojNjY2O2ZvbnQtc2l6ZTowLjk1cmVtfQ0KICAgICAgICB0YWJsZXtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7d2lkdGg6MTAwJTttYXJnaW4tdG9wOjEwcHh9DQogICAgICAgIHRoLHRke2JvcmRlcjoxcHggc29saWQgI2U2ZTZlNjtwYWRkaW5nOjhweDt0ZXh0LWFsaWduOmxlZnR9DQogICAgICAgIHRoe2JhY2tncm91bmQ6I2Y3ZjdmN30NCiAgICAgICAgLnRhZy1oaWdoe2JhY2tncm91bmQ6I2ZmZGRkZDtjb2xvcjojYjMwMDAwO3BhZGRpbmc6M3B4IDZweDtib3JkZXItcmFkaXVzOjRweH0NCiAgICAgICAgLnRhZy1tZWR7YmFja2dyb3VuZDojZmZmMGNjO2NvbG9yOiNiMzZiMDA7cGFkZGluZzozcHggNnB4O2JvcmRlci1yYWRpdXM6NHB4fQ0KICAgICAgICAudGFnLWxvd3tiYWNrZ3JvdW5kOiNlZWY3ZGQ7Y29sb3I6IzJmN2EwMDtwYWRkaW5nOjNweCA2cHg7Ym9yZGVyLXJhZGl1czo0cHh9DQogICAgICAgIC5zZWN0aW9ue21hcmdpbi10b3A6MThweH0NCiAgICAgICAgcHJle2JhY2tncm91bmQ6I2Y1ZjVmNTtwYWRkaW5nOjEwcHg7Ym9yZGVyLXJhZGl1czo2cHg7b3ZlcmZsb3c6YXV0b30NCiAgICAgICAgIiIiDQogICAgICAgIHBhcnRzID0gW10NCiAgICAgICAgcGFydHMuYXBwZW5kKCI8IWRvY3R5cGUgaHRtbD48aHRtbD48aGVhZD48bWV0YSBjaGFyc2V0PSd1dGYtOCc+PHRpdGxlPlByb2ZTY2FuIFJlcG9ydDwvdGl0bGU+IikNCiAgICAgICAgcGFydHMuYXBwZW5kKGYiPHN0eWxlPntjc3N9PC9zdHlsZT48L2hlYWQ+PGJvZHk+IikNCiAgICAgICAgcGFydHMuYXBwZW5kKCI8aGVhZGVyPiIpDQogICAgICAgIHBhcnRzLmFwcGVuZChmIjxkaXY+PGgxPlByb2ZTY2FuIFBybyBSZXBvcnQ8L2gxPjxkaXYgY2xhc3M9J21ldGEnPlRvb2w6IHtUT09MX05BTUV9IHwgVmVyc2lvbjoge1ZFUlNJT059IHwgRGV2ZWxvcGVyOiB7REVWRUxPUEVSfTwvZGl2PjwvZGl2PiIpDQogICAgICAgIHBhcnRzLmFwcGVuZCgiPC9oZWFkZXI+IikNCiAgICAgICAgcGFydHMuYXBwZW5kKGYiPGRpdiBjbGFzcz0nc2VjdGlvbic+PHN0cm9uZz5UYXJnZXQ6PC9zdHJvbmc+IHtyZXBvcnRbJ3RhcmdldCddfTxicj48c3Ryb25nPlNjYW5uZWQgYXQgKFVUQyk6PC9zdHJvbmc+IHtyZXBvcnRbJ3NjYW5uZWRfYXQnXX08L2Rpdj4iKQ0KICAgICAgICBwYXJ0cy5hcHBlbmQoIjxkaXYgY2xhc3M9J3NlY3Rpb24nPjxoMj5TdW1tYXJ5PC9oMj48dWw+IikNCiAgICAgICAgZm9yIGssIHYgaW4gcmVwb3J0WyJzdW1tYXJ5Il0uaXRlbXMoKToNCiAgICAgICAgICAgIHBhcnRzLmFwcGVuZChmIjxsaT48c3Ryb25nPntrfTo8L3N0cm9uZz4ge3Z9PC9saT4iKQ0KICAgICAgICBwYXJ0cy5hcHBlbmQoIjwvdWw+PC9kaXY+IikNCiAgICAgICAgcGFydHMuYXBwZW5kKCI8ZGl2IGNsYXNzPSdzZWN0aW9uJz48aDI+RmluZGluZ3M8L2gyPiIpDQogICAgICAgIHBhcnRzLmFwcGVuZCgiPHRhYmxlPjx0aGVhZD48dHI+PHRoPiM8L3RoPjx0aD5QYXJhbWV0ZXI8L3RoPjx0aD5FdmlkZW5jZSAobm90ZXMpPC90aD48dGg+U2NvcmU8L3RoPjx0aD5Db25maWRlbmNlPC90aD48dGg+UmVtZWRpYXRpb248L3RoPjwvdHI+PC90aGVhZD48dGJvZHk+IikNCiAgICAgICAgZm9yIGksIGYgaW4gZW51bWVyYXRlKHJlcG9ydFsiZmluZGluZ3MiXSwgc3RhcnQ9MSk6DQogICAgICAgICAgICBub3RlcyA9ICI8YnI+Ii5qb2luKGZbImV2aWRlbmNlIl0uZ2V0KCJub3RlcyIsIFtdKVs6MTJdKQ0KICAgICAgICAgICAgY29uZiA9IGZbImNvbmZpZGVuY2UiXQ0KICAgICAgICAgICAgdGFnID0gIiINCiAgICAgICAgICAgIGlmIGNvbmYgPT0gIkhJR0giOg0KICAgICAgICAgICAgICAgIHRhZyA9ICI8c3BhbiBjbGFzcz0ndGFnLWhpZ2gnPkhJR0g8L3NwYW4+Ig0KICAgICAgICAgICAgZWxpZiBjb25mID09ICJNRURJVU0iOg0KICAgICAgICAgICAgICAgIHRhZyA9ICI8c3BhbiBjbGFzcz0ndGFnLW1lZCc+TUVESVVNPC9zcGFuPiINCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgdGFnID0gIjxzcGFuIGNsYXNzPSd0YWctbG93Jz5MT1c8L3NwYW4+Ig0KICAgICAgICAgICAgcmVtZWRpYXRpb25faHRtbCA9ICI8dWw+Ig0KICAgICAgICAgICAgZm9yIHIgaW4gZlsicmVtZWRpYXRpb24iXVs6Nl06DQogICAgICAgICAgICAgICAgcmVtZWRpYXRpb25faHRtbCArPSBmIjxsaT57cn08L2xpPiINCiAgICAgICAgICAgIHJlbWVkaWF0aW9uX2h0bWwgKz0gIjwvdWw+Ig0KICAgICAgICAgICAgcGFydHMuYXBwZW5kKGYiPHRyPjx0ZD57aX08L3RkPjx0ZD57ZlsncGFyYW0nXX08L3RkPjx0ZD57bm90ZXN9PC90ZD48dGQ+e2ZbJ3Njb3JlJ119PC90ZD48dGQ+e3RhZ308L3RkPjx0ZD57cmVtZWRpYXRpb25faHRtbH08L3RkPjwvdHI+IikNCiAgICAgICAgcGFydHMuYXBwZW5kKCI8L3Rib2R5PjwvdGFibGU+PC9kaXY+IikNCiAgICAgICAgcGFydHMuYXBwZW5kKCI8ZGl2IGNsYXNzPSdzZWN0aW9uJz48aDI+RXhwb3NlZCBGaWxlczwvaDI+PHByZT57fTwvcHJlPjwvZGl2PiIuZm9ybWF0KGpzb24uZHVtcHMocmVwb3J0WyJzdW1tYXJ5Il0uZ2V0KCJleHBvc2VkX2ZpbGVzIiwgW10pLCBpbmRlbnQ9MikpKQ0KICAgICAgICBwYXJ0cy5hcHBlbmQoIjxkaXYgY2xhc3M9J3NlY3Rpb24nPjxoMj5PcGVuIERpcmVjdG9yaWVzPC9oMj48cHJlPnt9PC9wcmU+PC9kaXY+Ii5mb3JtYXQoanNvbi5kdW1wcyhyZXBvcnQuZ2V0KCJvcGVuX2RpcnMiLCBbXSksIGluZGVudD0yKSkpDQogICAgICAgIHBhcnRzLmFwcGVuZCgiPGRpdiBjbGFzcz0nc2VjdGlvbic+PGgyPlNlbnNpdGl2ZSBTYW1wbGVzIChzYW1wbGUpPC9oMj48cHJlPnt9PC9wcmU+PC9kaXY+Ii5mb3JtYXQoanNvbi5kdW1wcyhyZXBvcnQuZ2V0KCJzZW5zaXRpdmVfc2FtcGxlcyIsIHt9KSwgaW5kZW50PTIpKSkNCiAgICAgICAgcGFydHMuYXBwZW5kKCI8L2JvZHk+PC9odG1sPiIpDQogICAgICAgIHJldHVybiAiXG4iLmpvaW4ocGFydHMpDQoNCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KIyBDTEkNCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KZGVmIGxvYWRfY3ZlX2RiKHBhdGgpOg0KICAgIHRyeToNCiAgICAgICAgd2l0aCBvcGVuKHBhdGgsICJyIiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZmg6DQogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkKGZoKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb246DQogICAgICAgIHJldHVybiB7fQ0KDQpkZWYgbWFpbigpOg0KICAgIGJhbm5lcigpDQogICAgcGFyc2VyID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoZGVzY3JpcHRpb249ZiJ7VE9PTF9OQU1FfSAtIFByb2ZTY2FuIFBybyAodntWRVJTSU9OfSkiKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi11IiwgIi0tdXJsIiwgcmVxdWlyZWQ9VHJ1ZSwgaGVscD0iVGFyZ2V0IFVSTCAoZS5nLiBodHRwczovL2V4YW1wbGUuY29tKSIpDQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1tYXgtcGFnZXMiLCB0eXBlPWludCwgZGVmYXVsdD1NQVhfUEFHRVNfREVGQVVMVCwgaGVscD0iTWF4IHBhZ2VzIHRvIGNyYXdsIikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWRlbGF5IiwgdHlwZT1mbG9hdCwgZGVmYXVsdD1QT0xJVEVfREVMQVksIGhlbHA9IkRlbGF5IGJldHdlZW4gcmVxdWVzdHMgKHNlY29uZHMpIikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXByb2JlIiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iRW5hYmxlIGJlbmlnbiBwcm9iaW5nIChNVVNUIGhhdmUgcGVybWlzc2lvbikiKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tY3ZlLWRiIiwgaGVscD0iT3B0aW9uYWwgbG9jYWwgQ1ZFIG1hcHBpbmcgSlNPTiBmaWxlIikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXBhcmFsbGVsIiwgdHlwZT1pbnQsIGRlZmF1bHQ9MCwgaGVscD0iRW5hYmxlIHBhcmFsbGVsIGNyYXdsaW5nIHdpdGggTiB3b3JrZXJzIChvcHRpb25hbCkiKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tc3ViZG9tYWlucyIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9IlJ1biBzbWFsbCBzdWJkb21haW4gZW51bWVyYXRpb24iKQ0KICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tdGhyZWFkcyIsIHR5cGU9aW50LCBkZWZhdWx0PTEwLCBoZWxwPSJUaHJlYWRzIGZvciBzdWJkb21haW4gY2hlY2tzIikNCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItdiIsICItLXZlcmJvc2UiLCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxwPSJWZXJib3NlIG91dHB1dCIpDQogICAgYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkNCg0KICAgIGlmIGFyZ3MucHJvYmU6DQogICAgICAgIHByaW50KGNvbG9yKCI9PT0gUFJPQkUgTU9ERSBFTkFCTEVEID09PSIsIEZvcmUuWUVMTE9XLCBUcnVlKSkNCiAgICAgICAgcHJpbnQoIk9ubHkgZW5hYmxlIC0tcHJvYmUgaWYgeW91IGhhdmUgZXhwbGljaXQgd3JpdHRlbiBwZXJtaXNzaW9uIHRvIHRlc3QgdGhlIHRhcmdldC5cbiIpDQoNCiAgICBjdmVfZGIgPSBsb2FkX2N2ZV9kYihhcmdzLmN2ZV9kYikgaWYgYXJncy5jdmVfZGIgZWxzZSB7fQ0KICAgIHMgPSBQcm9mZXNzaW9uYWxTY2FubmVyKA0KICAgICAgICB0YXJnZXQ9YXJncy51cmwsDQogICAgICAgIG1heF9wYWdlcz1hcmdzLm1heF9wYWdlcywNCiAgICAgICAgZGVsYXk9YXJncy5kZWxheSwNCiAgICAgICAgcHJvYmU9YXJncy5wcm9iZSwNCiAgICAgICAgY3ZlX2RiPWN2ZV9kYiwNCiAgICAgICAgdmVyYm9zZT1hcmdzLnZlcmJvc2UsDQogICAgICAgIHBhcmFsbGVsX3dvcmtlcnM9YXJncy5wYXJhbGxlbA0KICAgICkNCg0KICAgIHN0YXJ0ID0gdGltZS50aW1lKCkNCiAgICBpZiBzLnBhcmFsbGVsX3dvcmtlcnM6DQogICAgICAgIHByaW50KGNvbG9yKGYiWypdIFN0YXJ0aW5nIHBhcmFsbGVsIGNyYXdsIHdpdGgge3MucGFyYWxsZWxfd29ya2Vyc30gd29ya2Vycy4uLiIsIEZvcmUuQ1lBTikpDQogICAgZWxzZToNCiAgICAgICAgcHJpbnQoY29sb3IoIlsqXSBTdGFydGluZyBwYXNzaXZlIGNyYXdsIChzaW5nbGUtdGhyZWFkKS4uLiIsIEZvcmUuQ1lBTikpDQogICAgcy5jcmF3bCgpDQogICAgZWxhcHNlZCA9IHRpbWUudGltZSgpIC0gc3RhcnQNCiAgICBwcmludChjb2xvcihmIlsqXSBDcmF3bGluZyBjb21wbGV0ZWQ6IHBhZ2VzIGZldGNoZWQ9e2xlbihzLnBhZ2VzKX0gaW4ge2VsYXBzZWQ6LjFmfXMiLCBGb3JlLkdSRUVOKSkNCg0KICAgIHByaW50KGNvbG9yKCJbKl0gUnVubmluZyBwYXNzaXZlIGNoZWNrcyAoY29tbW9uIGZpbGVzLCBvcGVuIGRpcnMsIGVycm9yIHNjYW4pLi4uIiwgRm9yZS5DWUFOKSkNCiAgICBzLmNoZWNrX2NvbW1vbl9maWxlcygpDQogICAgcy5kZXRlY3Rfb3Blbl9kaXJzKCkNCiAgICBzLnBhc3NpdmVfZXJyb3Jfc2NhbigpDQoNCiAgICBwcmludChjb2xvcigiWypdIENvbGxlY3RpbmcgYW5kIGFuYWx5emluZyBwYXJhbWV0ZXJzLi4uIiwgRm9yZS5DWUFOKSkNCiAgICBzLmFuYWx5emVfcGFyYW1zKCkNCg0KICAgIGlmIGFyZ3Muc3ViZG9tYWluczoNCiAgICAgICAgcHJpbnQoY29sb3IoIlsqXSBFbnVtZXJhdGluZyBjb21tb24gc3ViZG9tYWlucyAoRE5TKS4uLiIsIEZvcmUuQ1lBTikpDQogICAgICAgIHN1YmRvbWFpbnMgPSBzLmVudW1lcmF0ZV9zdWJkb21haW5zKHdvcmtlcnM9YXJncy50aHJlYWRzKQ0KICAgICAgICBpZiBzdWJkb21haW5zOg0KICAgICAgICAgICAgcHJpbnQoY29sb3IoZiJbIV0gU3ViZG9tYWlucyBkaXNjb3ZlcmVkOiB7bGVuKHN1YmRvbWFpbnMpfSIsIEZvcmUuWUVMTE9XKSkNCiAgICAgICAgICAgIGZvciBzZCwgaXAgaW4gc3ViZG9tYWlucy5pdGVtcygpOg0KICAgICAgICAgICAgICAgIHByaW50KGYiICAtIHtzZH0gLT4ge2lwfSIpDQoNCiAgICBpZiBhcmdzLnByb2JlOg0KICAgICAgICBwcmludChjb2xvcigiWypdIFJ1bm5pbmcgYmVuaWduIHByb2JlcyAocmVmbGVjdGlvbiAmIGRpZmYgY2hlY2tzKS4uLiIsIEZvcmUuQ1lBTikpDQogICAgICAgIHMucnVuX3Byb2JlcygpDQoNCiAgICBzLmZpbmFsaXplX2ZpbmRpbmdzKCkNCg0KICAgIGNvdW50cyA9IHsiSElHSCI6IDAsICJNRURJVU0iOiAwLCAiTE9XIjogMH0NCiAgICBmb3IgZm5kIGluIHMuZmluZGluZ3M6DQogICAgICAgIGNvdW50c1tmbmRbImNvbmZpZGVuY2UiXV0gPSBjb3VudHMuZ2V0KGZuZFsiY29uZmlkZW5jZSJdLCAwKSArIDENCg0KICAgIHByaW50KCJcbiIgKyAiPSIgKiA2MCkNCiAgICBwcmludChjb2xvcigiU2NhbiBTdW1tYXJ5IiwgRm9yZS5CTFVFLCBUcnVlKSkNCiAgICBwcmludChmIlRhcmdldCAgICAgICAgICAgOiB7YXJncy51cmx9IikNCiAgICBwcmludChmIlBhZ2VzIGNyYXdsZWQgICAgOiB7bGVuKHMucGFnZXMpfSIpDQogICAgcHJpbnQoZiJQYXJhbWV0ZXJzIGZvdW5kIDoge2xlbihzLnBhcmFtc19tYXApfSIpDQogICAgcHJpbnQoZiJGaW5kaW5ncyAgICAgICAgIDogSElHSD17Y291bnRzWydISUdIJ119IE1FRElVTT17Y291bnRzWydNRURJVU0nXX0gTE9XPXtjb3VudHNbJ0xPVyddfSIpDQogICAgcHJpbnQoIj0iICogNjApDQoNCiAgICBmb3IgZm5kIGluIHMuZmluZGluZ3M6DQogICAgICAgIHRhZyA9IGYiW3tmbmRbJ2NvbmZpZGVuY2UnXX1dIg0KICAgICAgICBpZiBmbmRbImNvbmZpZGVuY2UiXSA9PSAiSElHSCI6DQogICAgICAgICAgICBwcmludChjb2xvcih0YWcsIEZvcmUuUkVELCBUcnVlKSwgY29sb3IoZm5kWyJwYXJhbSJdLCBGb3JlLllFTExPVyksIGYic2NvcmU9e2ZuZFsnc2NvcmUnXX0iKQ0KICAgICAgICBlbGlmIGZuZFsiY29uZmlkZW5jZSJdID09ICJNRURJVU0iOg0KICAgICAgICAgICAgcHJpbnQoY29sb3IodGFnLCBGb3JlLk1BR0VOVEEpLCBjb2xvcihmbmRbInBhcmFtIl0sIEZvcmUuV0hJVEUpKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcHJpbnQoY29sb3IodGFnLCBGb3JlLkNZQU4pLCBjb2xvcihmbmRbInBhcmFtIl0sIEZvcmUuV0hJVEUpKQ0KDQogICAganNvbnAsIGh0bWxwID0gcy5leHBvcnRfcmVwb3J0KCkNCiAgICBwcmludCgiXG4iICsgY29sb3IoIlsqXSBSZXBvcnRzIGdlbmVyYXRlZDoiLCBGb3JlLkdSRUVOKSkNCiAgICBwcmludCgiIC0iLCBqc29ucCkNCiAgICBwcmludCgiIC0iLCBodG1scCkNCiAgICBwcmludChjb2xvcigiXG5Eb25lLiBSZXZpZXcgdGhlIEhUTUwgcmVwb3J0IGZvciBkZXRhaWxzIGFuZCByZW1lZGlhdGlvbiBhZHZpY2UuIiwgRm9yZS5HUkVFTikpDQoNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgbWFpbigpDQo='))